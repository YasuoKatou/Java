<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="yks.ticket.lite.dao.SessionDao">
  <resultMap id="sessionResultMap" type="yks.ticket.lite.entity.SessionEntity" autoMapping="true">
  </resultMap>

  <insert id="insert">
    insert into t_session (
        session_id  --セッションID
      , user_id     --ユーザ識別子
      , createUserId  --作成者ID
      , versionNo     --バージョンNo
    ) values (
        #{session_id}
      , #{user_id}
      , #{user_id}
      , 1
    )
  </insert>

  <select id="findUserBySessionId" resultMap="yks.ticket.lite.dao.master.UserMasterDao.userMasterResultMap">
    select
        M.id       --識別子
      , M.name1    --性
      , M.name2    --名
      , M.email    --メールアドレス
      , M.language_id  --言語ID
    from t_session T
    inner join m_user M
        on M.id = T.user_id
    where T.session_id = #{session_id}
  </select>

  <delete id="deleteBySessionId">
    delete from t_session
    where session_id = #{session_id}
  </delete>

  <delete id="deleteByUserId">
    delete from t_session
    where user_id = #{user_id}
  </delete>
</mapper>